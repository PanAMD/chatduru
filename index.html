<html>
  <head>
    <title>
      Node.js Chatduru
    </title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery.js"></script> 

  <style>
    #chat{
      position:relative;
      width:100%;
      float:left;
      min-height:100;
      height: 90%;
      overflow: auto;
    }
  </style>

  </head>
  <body>
    <div class="container">
      <div class="page-header">
        <h1>Node.js Chat <small>developed by <a href="https://geekytheory.com">Geeky Theory</a></small></h1>
        
      </div>
      <div id='content' class='row' style='height: 70%;'>
        <div class='col-md-2'></div>
        <div id='chatContent' class='col-md-6'>
          <div class='panel panel-success'>
            <div class='panel-heading'>
              CHAT
            </div>
            <div id='chat' class='panel-body'></div>
          </div>
        <div> 
         <form id="sendMessage" class="input-group" style="text-align:center; margin:0 auto;">
           <input id="message" class="form-control input-lg" type="text">
              <span class="input-group-btn">
              <button class="btn btn-lg btn-primary" type="submit">Send</button>
              </span>
              </form>
        </div>
        </div>
     
    </div>
   <script src = "/socket.io/socket.io.js"></script>
   <script type= "text/javascript">
     $(function(){
       var socket = io.connect();
       var messageForm = $("#sendMessage");
       var message = $("#message");
       var chat = $("#chat");

       var nickname = $("#nickname");
       var setNick = $("#setNick");

       var users = $("#users");

       setNick.click(function(e){
         e.preventDefault();
         socket.emit('newUser',nickname.val(),function(data) {
           if(data){
             $("#nickContaniner").hide();
             $("#content").show();
           }
           else{
             $("#login-error").show();
           }
         });
       });
  
       messageForm.submit(function(e){
         e.preventDefault();
         if(message.val()!="") socket.emit("sendMessage",message.val());
         message.val('');
       });
       socket.on('newMessage',function(data){
         chat.append(data.nick+' - '+data.msg+"<br>");
       });
       socket.on('usernames', function(data){
         var usernamesString = "";
         for(var username in data){
           usernameString+=username + "<br/>";
         }
         users.html(usernamesString);
       });
     });
   </script>
  </body>
</html>